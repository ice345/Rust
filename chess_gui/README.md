# Chess GUI - Modular Structure

<!--toc:start-->
- [Chess GUI - Modular Structure](#chess-gui-modular-structure)
  - [项目结构](#项目结构)
  - [模块说明](#模块说明)
    - [`types.rs`](#typesrs)
    - [`board.rs`](#boardrs)
    - [`ai.rs`](#airs)
    - [`ui.rs`](#uirs)
    - [`game.rs`](#gamers)
    - [`lib.rs`](#librs)
    - [`main.rs`](#mainrs)
  - [构建和运行](#构建和运行)
  - [功能特性](#功能特性)
  - [重构改进](#重构改进)
  - [技术栈](#技术栈)
<!--toc:end-->

这是一个用 Rust 和 egui 构建的国际象棋游戏，已经重构为模块化结构以提高可维护性。

## 项目结构

```
src/
├── main.rs          # 程序入口点
├── lib.rs           # 库入口，导出所有模块
├── types.rs         # 基础类型定义
├── board.rs         # 棋盘逻辑和走法生成
├── ai.rs            # AI 算法实现
├── ui.rs            # 用户界面和应用程序逻辑
├── game.rs          # 游戏状态管理
└── main_backup.rs   # 原始 main.rs 文件备份
```

## 模块说明

### `types.rs`

- 定义了基础的游戏类型：
  - `PieceType`: 棋子类型（兵、车、马、象、后、王）
  - `Color`: 棋子颜色（白、黑）
  - `Piece`: 棋子结构（类型+颜色）
  - `Move`: 走法结构
  - `GameState`: 游戏状态
  - `AIDifficulty`: AI 难度等级

### `board.rs`

- 实现了棋盘的核心逻辑：
  - 棋盘表示和初始化
  - 走法生成（包括普通走法、特殊走法如王车易位、过路兵等）
  - 走法合法性检查
  - 将军判断
  - 棋子移动执行

### `ai.rs`

- 实现了 AI 算法：
  - minimax 搜索算法
  - alpha-beta 剪枝
  - 置换表优化
  - 启发式评估函数
  - 移动排序
  - 迭代加深搜索

### `ui.rs`

- 处理用户界面：
  - 棋盘渲染
  - 用户交互处理
  - 游戏状态显示
  - 升变对话框
  - 游戏结束界面

### `game.rs`

- 管理游戏逻辑：
  - 游戏状态管理
  - 游戏流程控制
  - AI 思考过程管理
  - 游戏规则验证

### `lib.rs`

- 作为库的入口点，导出所有模块供其他部分使用

### `main.rs`

- 程序的入口点，负责启动 GUI 应用程序

## 构建和运行

```bash
# 构建项目
cargo build

# 运行项目
cargo run

# 构建发布版本
cargo build --release
```

## 功能特性

- 完整的国际象棋规则实现
- 图形用户界面
- AI 对手（支持多个难度等级）
- 特殊走法支持（王车易位、过路兵、兵的升变）
- 游戏状态检测（将军、将死、和棋）
- 优化的 AI 搜索算法

## 重构改进

通过模块化重构，项目获得了以下改进：

1. **更好的代码组织**: 相关功能被分组到专门的模块中
2. **提高可维护性**: 每个模块专注于单一职责
3. **便于测试**: 可以独立测试各个模块的功能
4. **更好的可读性**: 代码结构更清晰，易于理解
5. **便于扩展**: 新功能可以更容易地添加到相应的模块中

## 技术栈

- **Rust**: 系统编程语言
- **egui**: 即时模式 GUI 框架
- **eframe**: egui 的应用程序框架
